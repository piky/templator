<?xml version="1.0" encoding="UTF-8"?>
<tns:root xmlns:tns="http://www.example.org/zbx_template_new/"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://www.example.org/zbx_template_new/ ../../main/resources/templates/zbx_template_new.xsd ">
  <template>
	     <name>Template Juniper</name>
	     <description>Template Juniper</description>
	     <sysObjectID>{sysobjectid}</sysObjectID>
	     <discoveryRules>
	  	     <discoveryRule>
	  				     <name>CPU and Memory Discovery</name>
                    <snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.4.1.2636.3.1.13.1.5]</snmp_oid>
                    <key>jnxOperatingTable.discovery</key>
                    <description>Scanning JUNIPER-MIB::jnxOperatingTable for CPU and Memory 
                    http://kb.juniper.net/InfoCenter/index?page=content&amp;id=KB17526&amp;actp=search. Filter limits results to Routing Engines</description>
                    <filter>
                        <evaltype>0</evaltype>
                        <formula/>
                        <conditions>
							           <condition>
                                <macro>{#SNMPVALUE}</macro>
                                <!-- <value>9\.[0-9]\.[0-9]\.[0-9]</value>  -->
                                <value>Routing Engine.*</value>
                                <operator>8</operator>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
	  	     </discoveryRule>
	     </discoveryRules>
	     <metrics>
	        <cpuLoad>
            <name>Cpu Load</name>
            <group>Cpu</group>
            <oid>1.3.6.1.4.1.2636.3.1.13.1.21.{#SNMPINDEX}</oid>
            <snmpObject>jnxOperating5MinLoadAvg[{#SNMPVALUE}]</snmpObject>
            <mib>JUNIPER-MIB</mib>
            <ref>http://kb.juniper.net/library/CUSTOMERSERVICE/GLOBAL_JTAC/BK26199/SRX%20SNMP%20Monitoring%20Guide_v1.1.pdf</ref>
            <vendorDescription>The CPU Load Average over the last 5 minutesHere it will be shown as percentage valueZero if unavailable or inapplicable.</vendorDescription>
            <description>Cpu load in %</description>
            <history>30</history>
            <trends>365</trends>
            <units>%</units>
            <update>30</update>
            <valueType>3</valueType>
            <discoveryRule>CPU and Memory Discovery</discoveryRule>
            <triggers>
               <trigger>
                  <expression>{Template Juniper:jnxOperating5MinLoadAvg[{#SNMPVALUE}].avg(300)}&gt;90</expression>
                  <name>CPU load is too high</name>
                  <url/>
                  <priority>3</priority>
                  <description/>
               </trigger>
            </triggers>
         </cpuLoad>
	        <memoryUsedPercentage>
            <name>Memory utilization</name>
            <group>Memory</group>
            <oid>1.3.6.1.4.1.2636.3.1.13.1.11.{#SNMPINDEX}</oid>
            <snmpObject>jnxOperatingBuffer[{#SNMPVALUE}]</snmpObject>
            <mib>JUNIPER-MIB</mib>
            <ref>http://kb.juniper.net/library/CUSTOMERSERVICE/GLOBAL_JTAC/BK26199/SRX%20SNMP%20Monitoring%20Guide_v1.1.pdf</ref>
            <vendorDescription>The buffer pool utilization in percentageof this subject.  Zero if unavailable or inapplicable.</vendorDescription>
            <description>Memory utilization in %</description>
            <history>30</history>
            <trends>365</trends>
            <units>%</units>
            <update>30</update>
            <valueType>3</valueType>
            <discoveryRule>CPU and Memory Discovery</discoveryRule>
            <triggers>
               <trigger>
                  <expression>{Template Juniper:jnxOperatingBuffer[{#SNMPVALUE}].avg(300)}&gt;90</expression>
                  <name>Memory utilization is too high</name>
                  <url/>
                  <priority>3</priority>
                  <description/>
               </trigger>
            </triggers>
         </memoryUsedPercentage>
	     </metrics>
  </template>
  
  </tns:root>
