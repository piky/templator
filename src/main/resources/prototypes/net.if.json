[
	{
		"prototype": "net.if.status",
		"name": "Operational status",
		"description": "Used memory in Bytes",
		"group": "Network_Interfaces",
		"delay": "1m",
		"history": "2w",
		"trends": "0d",
		"valueType": "INTEGER",
		"triggers": [
			{
				"documentation": "This trigger expression works as follows:\n1. Can be triggered if ifOperStatus = 2\n2. {$IFCONTROL:\"{#IFNAME}\"}=1 - user can redefine Context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down.\nif IFNAME not available - use SNMPINDEX (IFINDEX))\n3. {TEMPLATE_NAME:METRIC.diff()}=1) - trigger fires only ifOperStatus ever was up(1) before. (do not fire ethernal off interfaces.)\nWARNING. if closed manually - won't fire again on next poll. because of .diff. Thats why manual_close is disabled.",
				"id": "if.down",
				"expression": "{$IFCONTROL:\"{#IFNAME}\"}=1 and ({TEMPLATE_NAME:METRIC.last()}=2 and {TEMPLATE_NAME:METRIC.diff()}=1)",
				"recovery_expression": "{TEMPLATE_NAME:METRIC.last()}<>2",
				"manual_close": "NO",
				"name": "Link down",
				"description": "Interface is down",
				"priority": 3
			}
		]
	},
	{
		"prototype": "net.if.in",
		"name": "Bits received",
		"group": "Network_Interfaces",
		"valueType": "INTEGER",
		"delay": "3m",
		"history": "30d",
		"units": "bps",
		"triggers": [
			{
				"documentation": "- This trigger uses 3% hysteresis (WARNING: do not change {$IF_UTIL_MAX:\"{#IFNAME}\"} below or equal to 3%\n- Additionally added 'and net.if.speed[*].last()>0' in order to fix ZBX-12688",
				"id": "if.util_high",
				"expression": "({TEMPLATE_NAME:METRIC.avg(15m)}>({$IF_UTIL_MAX:\"{#IFNAME}\"}/100)*{TEMPLATE_NAME:__net.if.speed__.last()} or\n{TEMPLATE_NAME:__net.if.out__.avg(15m)}>({$IF_UTIL_MAX:\"{#IFNAME}\"}/100)*{TEMPLATE_NAME:__net.if.speed__.last()}) and\n{TEMPLATE_NAME:__net.if.speed__.last()}>0",
				"recovery_expression": "{TEMPLATE_NAME:METRIC.avg(15m)}<(({$IF_UTIL_MAX:\"{#IFNAME}\"}-3)/100)*{TEMPLATE_NAME:__net.if.speed__.last()} and\n{TEMPLATE_NAME:__net.if.out__.avg(15m)}<(({$IF_UTIL_MAX:\"{#IFNAME}\"}-3)/100)*{TEMPLATE_NAME:__net.if.speed__.last()}",
				"manual_close": "YES",
				"name": "High bandwidth usage >{$IF_UTIL_MAX:\"{#IFNAME}\"}%",
				"priority": 2,
				"dependsOn": [
					"if.down"
				]
			}
		],
		"graphs": [
			{
				"name": "Network traffic",
				"graphItems": [
					{
						"drawtype": "GRADIENT_LINE",
						"name": "net.if.in",
						"yaxisside": "LEFT"
					},
					{
						"drawtype": "BOLD_LINE",
						"name": "net.if.out",
						"yaxisside": "LEFT"
					},
					{
						"drawtype": "LINE",
						"name": "net.if.out.errors",
						"yaxisside": "RIGHT"
					},
					{
						"drawtype": "LINE",
						"name": "net.if.in.errors",
						"yaxisside": "RIGHT"
					},
					{
						"drawtype": "LINE",
						"name": "net.if.out.discards",
						"yaxisside": "RIGHT"
					},
					{
						"drawtype": "LINE",
						"name": "net.if.in.discards",
						"yaxisside": "RIGHT"
					}
				]
			}
		]
	},
	{
		"prototype": "net.if.out",
		"name": "Bits sent",
		"group": "Network_Interfaces",
		"delay": "3m",
		"history": "30d",
		"valueType": "INTEGER",
		"units": "bps"
	},
	{
		"prototype": "net.if.in.errors",
		"name": "Inbound packets with errors",
		"group": "Network_Interfaces",
		"delay": "5m",
		"history": "1w",
		"valueType": "INTEGER",
		"triggers": [
			{
				"documentation": "Recovers when below 80% of {$IF_ERRORS_WARN:\"{#IFNAME}\"} (see ZBX-13128)",
				"id": "if.errors",
				"expression": "{TEMPLATE_NAME:METRIC.avg(5m)}>{$IF_ERRORS_WARN:\"{#IFNAME}\"}\nor {TEMPLATE_NAME:__net.if.out.errors__.avg(5m)}>{$IF_ERRORS_WARN:\"{#IFNAME}\"}",
				"recovery_expression": "{TEMPLATE_NAME:METRIC.avg(5m)}<{$IF_ERRORS_WARN:\"{#IFNAME}\"}*0.8\nand {TEMPLATE_NAME:__net.if.out.errors__.avg(5m)}<{$IF_ERRORS_WARN:\"{#IFNAME}\"}*0.8",
				"manual_close": "YES",
				"name": "High error rate",
				"priority": 2,
				"description": "Recovers when below 80% of {$IF_ERRORS_WARN:\"{#IFNAME}\"} threshold",
				"dependsOn": [
					"if.down"
				]
			}
		]
	},
	{
		"prototype": "net.if.out.errors",
		"name": "Outbound packets with errors",
		"group": "Network_Interfaces",
		"delay": "5m",
		"history": "1w",
		"valueType": "INTEGER"
	},
	{
		"prototype": "net.if.in.discards",
		"name": "Inbound packets discarded",
		"group": "Network_Interfaces",
		"delay": "5m",
		"history": "1w",
		"valueType": "INTEGER"
	},
	{
		"prototype": "net.if.out.discards",
		"name": "Outbound packets discarded",
		"group": "Network_Interfaces",
		"delay": "5m",
		"history": "1w",
		"valueType": "INTEGER"
	},
	{
		"prototype": "net.if.speed",
		"name": "Speed",
		"group": "Network_Interfaces",
		"delay": "5m",
		"history": "1w",
		"trends": "0d",
		"valueType": "INTEGER",
		"units": "bps",
		"triggers": [
			{
				"documentation": "Might be problems with Mikrotik. Also checked:\n - That type is Ethernet\n- That interfaces is not in down status (issue on HP Procurve)",
				"id": "if.speed.not_max",
				"expression": "{TEMPLATE_NAME:METRIC.change()}<0 and {TEMPLATE_NAME:METRIC.last()}>0\nand (\n{TEMPLATE_NAME:__net.if.type__.last()}=6 or\n{TEMPLATE_NAME:__net.if.type__.last()}=7 or\n{TEMPLATE_NAME:__net.if.type__.last()}=11 or\n{TEMPLATE_NAME:__net.if.type__.last()}=62 or\n{TEMPLATE_NAME:__net.if.type__.last()}=69 or\n{TEMPLATE_NAME:__net.if.type__.last()}=117\n)\nand\n({TEMPLATE_NAME:__net.if.status__.last()}<>2)",
				"recoveryExpression": "({TEMPLATE_NAME:METRIC.change()}>0 and {TEMPLATE_NAME:METRIC.prev()}>0) or\n({TEMPLATE_NAME:__net.if.status__.last()}=2)",
				"manual_close": "YES",
				"name": "Ethernet has changed to lower speed than it was before",
				"priority": 1,
				"description": "This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Ack to close.",
				"dependsOn": [
					"if.down"
				]
			}
		]
	},
	{
		"prototype": "net.if.type",
		"name": "Interface type",
		"group": "Network_Interfaces",
		"delay": "1h",
		"history": "1w",
		"trends": "0d",
		"valueType": "INTEGER"
	}
]